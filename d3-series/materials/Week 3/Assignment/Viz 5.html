<html>
  <body>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style>
      @keyframes spin {
        to {
          transform: rotate(-360deg);
        }
      }

      body {
        margin: 0;
      }

      main {
        background-color: black;
        overflow: hidden;
      }

      img {
        animation: spin 2s infinite linear;
        display: block;
        height: 100vh;
        margin: auto;
        width: 100vh;
      }

      svg {
        height: 100%;
        position: absolute;
        top: 0;
        width: 100%;
      }

      .g-rotate {
        animation: spin 2s infinite linear;
        transform-box: fill-box;
        transform-origin: center;
      }
      .g-translate {
        transition: 2s all linear;
      }
      path {
        transform: scale(3);
      }
    </style>
    <script>
      d3.json("./data.json")
        .then((data) => {
          const padding = 180; // Approximate width of path.
          const getRandom = (min, max) => Math.random() * (max - min) + min;
          const getX = () => getRandom(0, window.innerWidth - padding);
          const getY = () => getRandom(0, window.innerHeight - padding);

          const updateViz = (data) => {
            const circles = d3
              .select("main svg")
              .selectAll(".g-translate")
              .data(data);

            circles
              .enter()
              .append("g")
              .attr("class", "g-translate")
              .attr("transform", () => `translate(${getX()}, ${getY()})`)
              .append("g")
              .attr("class", "g-rotate")
              .append("path")
              .attr(
                "d",
                "M59.795,26.568c-0.684-2.887-2.979-4.871-5.084-4.363c-0.186,0.044-0.365,0.112-0.54,0.193 c-2.333-5.721-5.968-9.411-9.711-11.782l1.335-2.669c0.247-0.494,0.047-1.095-0.447-1.342c-0.494-0.246-1.094-0.047-1.342,0.447 L42.727,9.61c-0.619-0.328-1.236-0.629-1.845-0.895l0.967-2.9c0.175-0.524-0.108-1.091-0.632-1.265 c-0.528-0.177-1.09,0.108-1.265,0.632l-0.933,2.8c-0.694-0.246-1.368-0.456-2.015-0.634l0.844-2.533 c0.175-0.524-0.108-1.091-0.632-1.265c-0.527-0.177-1.09,0.108-1.265,0.632l-0.899,2.696c-1.268-0.26-2.345-0.396-3.153-0.468V4.5 c0-0.553-0.447-1-1-1s-1,0.447-1,1V6.34c-0.527,0.022-1.444,0.085-2.635,0.264l-0.378-2.269c-0.091-0.545-0.605-0.921-1.15-0.822 c-0.545,0.091-0.913,0.606-0.822,1.15l0.385,2.308c-1.076,0.237-2.264,0.56-3.519,1.004l-0.931-2.793 c-0.175-0.523-0.735-0.809-1.265-0.632c-0.523,0.174-0.807,0.74-0.632,1.265l0.964,2.892c-0.866,0.377-1.747,0.821-2.63,1.327 l-1.492-2.983c-0.248-0.494-0.847-0.693-1.342-0.447c-0.494,0.247-0.694,0.848-0.447,1.342l1.576,3.152 c-0.885,0.605-1.756,1.295-2.604,2.064l-2.37-2.37c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414l2.358,2.358 c-3.057,3.275-5.613,7.844-6.797,14.242c-0.015,0.083-0.025,0.167-0.04,0.25c-0.254-0.07-0.512-0.118-0.776-0.118 C1.73,28.939,0,31.322,0,34.363s1.73,5.424,3.939,5.424c0.404,0,0.798-0.102,1.177-0.267c0.701,2.671,1.863,5.179,3.458,7.378 c3.179,4.382,9.447,9.605,21.259,9.606l0.545-0.004l0.572,0.004c11.81,0,18.079-5.224,21.259-9.606 c2.88-3.97,4.346-8.945,4.229-14.075c0.034,0.001,0.068,0.014,0.103,0.014c0.228,0,0.454-0.026,0.674-0.079 C59.363,32.245,60.496,29.526,59.795,26.568z  M23,32.5 c-4.407,0-7.369-2.534-7.369-6.307c0-3.326,2.706-6.032,6.031-6.032c2.743,0,4.976,2.232,4.976,4.976c0,2.282-1.857,4.14-4.141,4.14 c-1.919,0-3.48-1.562-3.48-3.48c0-1.632,1.328-2.96,2.96-2.96c0.553,0,1,0.447,1,1s-0.447,1-1,1c-0.529,0-0.96,0.431-0.96,0.96 c0,0.816,0.664,1.48,1.48,1.48c1.181,0,2.141-0.96,2.141-2.14c0-1.641-1.335-2.976-2.976-2.976c-2.223,0-4.031,1.809-4.031,4.032 c0,3.175,2.773,4.307,5.369,4.307c3.225,0,5-2.131,5-6c0-0.553,0.447-1,1-1s1,0.447,1,1C30,29.434,27.317,32.5,23,32.5z M39.601,44.214c-0.847,1.465-3.13,4.235-5.717,4.235c-1.115,0-2.689-0.533-3.856-3.073c-0.835-1.818-0.87-3.346-0.104-4.539 c1.186-1.85,3.834-2.126,5.307-2.126c0.674,0,1.355,0.059,1.921,0.166c1.242,0.233,1.546,0.791,1.867,1.616 c0.068,0.174,0.149,0.383,0.266,0.636c0.115,0.251,0.221,0.449,0.309,0.614C40.007,42.525,40.232,43.12,39.601,44.214z M41.969,30.839c-2.743,0-4.976-2.232-4.976-4.976c0-2.282,1.857-4.14,4.141-4.14c1.919,0,3.48,1.562,3.48,3.48 c0,1.632-1.328,2.96-2.96,2.96c-0.553,0-1-0.447-1-1s0.447-1,1-1c0.529,0,0.96-0.431,0.96-0.96c0-0.816-0.664-1.48-1.48-1.48 c-1.181,0-2.141,0.96-2.141,2.14c0,1.641,1.335,2.976,2.976,2.976c2.223,0,4.031-1.809,4.031-4.032c0-3.175-2.773-4.307-5.369-4.307 c-3.225,0-5,2.131-5,6c0,0.553-0.447,1-1,1s-1-0.447-1-1c0-4.935,2.683-8,7-8c4.407,0,7.369,2.534,7.369,6.307 C48,28.132,45.294,30.839,41.969,30.839z"
              )
              .attr("fill", (data) => data.color);

            circles.exit().remove();

            circles.attr("transform", () => `translate(${getX()}, ${getY()})`);
          };

          const animate = (data) => {
            updateViz(data);
            const loop = setInterval(() => {
              updateViz(data);
            }, 2000);
          };

          animate(data);
        })
        .catch((error) => console.log("Whoops!"));
    </script>
    <main>
      <img src="./spiral.jpg" />
      <svg></svg>
    </main>
  </body>
</html>
